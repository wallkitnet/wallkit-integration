(()=>{"use strict";var e="https://cdn.wallkit.net",t=e+"/assets",n=[document.location.origin,"http://127.0.0.1:8000","https://wallkit.net","https://dev.wallkit.net","https://demo.wallkit.net"],i="500",o="250",r="firebase-ui-placeholder",a="wk-frame",s={apiKey:"AIzaSyAoRdxZIlUE0HInqtzDid6rNxluhs5nCqg",authDomain:"wallkit-production.firebaseapp.com",databaseURL:"https://wallkit-production.firebaseio.com",projectId:"wallkit-production",storageBucket:"wallkit-production.appspot.com",messagingSenderId:"779443518820",appId:"1:779443518820:web:ffc6660647590674e20e71",measurementId:"G-GWJ1GC5B30"};function l(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var c={DOM_ERROR:"DOM_ERROR",ARGUMENT_ERROR:"ARGUMENT_ERROR"},u={DOM_ERROR:"DOM Manipulation gone wrong",ARGUMENT_ERROR:"One of the argument were not provided"},h=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,n=[{key:"isErrorRecognisable",value:function(e){return!!c[e]}},{key:"getErrorTypeMessage",value:function(e){var t;return null!==(t=u[e])&&void 0!==t?t:"Unrecognised Error"}},{key:"handleError",value:function(t,n){if(n&&this.isErrorRecognisable(n)){var i=null!=t?t:e.getErrorTypeMessage(n),o="ERROR::".concat(n,"; ").concat(i,";");throw console.log(o),new e(o)}var r="ERROR::".concat(n,";");throw console.log(r),new e(r)}},{key:"checkRequiredArgument",value:function(e,t){void 0===e&&this.handleError("Argument ".concat(t," is not provided"),c.ARGUMENT_ERROR)}}],null&&l(t.prototype,null),n&&l(t,n),e}(),f=function(){return!!document},d=function(e){return f()?!!document.querySelector(e):h.handleError("Document is not available",c.DOM_ERROR)},p=function(e,t){if(!f())return h.handleError("Document is not available",c.DOM_ERROR);if(!e)return h.checkRequiredArgument(e);var n=document.createElement(e),i=null!=t?t:{},o=i.id,r=i.className,a=i.styles,s=i.attributes;if(o&&(n.id=o),r&&n.setAttribute("class",r),a&&Object.keys(a)&&Object.keys(a).length)for(var l in a)a.hasOwnProperty(l)&&(n.style[l]=a[l]);if(s&&Object.keys(s)&&Object.keys(s).length)for(var u in s)s.hasOwnProperty(u)&&(n[u]=s[u]);return n},v=function(e){return f()?e?document.body.appendChild(e):h.checkRequiredArgument(e,"element"):h.handleError("Document is not available",c.DOM_ERROR)},m=function(e,t){if(!f())return h.handleError("Document is not available",c.DOM_ERROR);if(!d("#"+t)){var n=document.querySelector("head"),i=document.createElement("link");return t&&(i.id=t),i.rel="stylesheet",i.type="text/css",i.href=e,i.media="all",n.appendChild(i)}},b=function(e,t,n){if(!f())return h.handleError("Document is not available",c.DOM_ERROR);if(!d("#"+t)){var i=p("script",{id:t,attributes:{src:e}});return n&&i.addEventListener("load",n,{once:!0}),v(i)}};const w=p,y=v,k=d;function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function O(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var E=function(){function e(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),e.instance?e.instance:(e.instance=this,this.listeners=[],this)}var t,n;return t=e,(n=[{key:"subscribe",value:function(e,t,n){this.listeners.push({name:e,callback:t,options:n})}},{key:"unsubscribe",value:function(e,t){this.listeners=this.listeners.filter((function(n){return n.name!==e||n.callback!==t}))}},{key:"notify",value:function(e,t){var n=[];this.listeners.forEach((function(i,o){var r;e===i.name&&(i.callback(t),null!=i&&null!==(r=i.options)&&void 0!==r&&r.once&&n.push(o))})),this.listeners=this.listeners.filter((function(e,t){return!n.includes(t)}))}}])&&O(t.prototype,n),e}(),T="frame-created",j="success-auth",R="wallkit-js-sdk-loaded",S="frame-message",P="frame-modal-closed",C="modal-closed",A="wk-event-modal",W="wk-event-modals-ready",L="wk-event-route-change";const I=j,_="success-firebase-auth",x=S,D="wk-event-logout",M="wk-firebase-token",F="wk-event-firebase-token",U="wk-event-token",N="wk-event-get-token",z="wk-event-auth",G="wk-event-registration",H="wk-event-one-tap-sign-in",q="wk-event-firebase-custom-token";function K(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function B(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function V(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function J(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}var X=new WeakSet,Y=new WeakSet,Z=new WeakSet,$=new WeakSet,Q=new WeakSet,ee=new WeakSet,te=new WeakSet,ne=new WeakSet,ie=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),ne.add(this),te.add(this),ee.add(this),Q.add(this),$.add(this),Z.add(this),Y.add(this),X.add(this),this.options=t,this.modalFrame=t?t.resourceFrame:null,this.content=t?t.content:null,this.modalWrapper=null,this.modalContent=null,this.loaderElement=null,this.isLoading=!1,this.closeOutside=!0,this.onClose=t?t.onClose:null}var t,n;return t=e,(n=[{key:"bindCloseEvent",value:function(e){return e.addEventListener("click",this.hide.bind(this))}},{key:"insertContent",value:function(e){this.modalContent&&e&&("string"==typeof e?this.modalContent.insertAdjacentHTML("beforeend",e):e instanceof HTMLElement&&this.modalContent.appendChild(e))}},{key:"toggleLoader",value:function(e){this.isLoading=e,this.loaderElement.style.display=e?"flex":"none"}},{key:"open",value:function(e,t){this.modalFrame&&(this.modalFrame.openFrame(e,t),this.show())}},{key:"destroy",value:function(){}},{key:"show",value:function(){this.modalWrapper.style.display="flex"}},{key:"hide",value:function(){(new E).notify(C,{name:J(this,X,oe).call(this)}),this.onClose&&this.onClose(),this.modalWrapper.style.display="none"}},{key:"resize",value:function(e,t){this.modalFrame&&this.modalFrame.resize(e,t)}},{key:"sendEvent",value:function(e,t,n){this.modalFrame&&this.modalFrame.sendEvent(e,t,n)}},{key:"openByHash",value:function(){var e=function(){var e=/#WkModal\((.*)\)$/.exec(decodeURIComponent(window.location.hash));if(e&&e[1]){var t=e[1].split(/,(.+)/);if(void 0!==t[1])try{t[1]=JSON.parse(t[1])}catch(e){t[1]={value:t[1].trim()}}return window.location.hash="",{name:t[0],params:"object"===g(t[1])?t[1]:null}}}();e&&this.open(e.name,e.params)}},{key:"onReady",value:function(){var e;null!==(e=this.options)&&void 0!==e&&e.onReady&&this.options.onReady(this)}},{key:"init",value:function(){J(this,$,se).call(this),J(this,Q,le).call(this),J(this,ee,ce).call(this),J(this,te,ue).call(this),this.onReady()}}])&&V(t.prototype,n),e}();function oe(){var e,t;return null!==(e=null===(t=this.options)||void 0===t?void 0:t.modalName)&&void 0!==e?e:"wk-modal"}function re(e,t,n){for(var i=J(this,X,oe).call(this)+"-"+t,o=0,r=i;k("#"+r);)r=i+"-"+ ++o;return w(e,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?K(Object(n),!0).forEach((function(t){B(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({id:r},n))}function ae(){var e=J(this,Y,re).call(this,"div","close-btn",{className:"wallkit-modal-wrapper__close-btn"});return e.innerHTML="&#xd7;",this.bindCloseEvent(e),e}function se(){var e,t,n=this,i="wallkit-modal-wrapper";return null!==(e=this.options)&&void 0!==e&&e.className&&(i+=" "+(null===(t=this.options)||void 0===t?void 0:t.className)),this.modalWrapper=J(this,Y,re).call(this,"div","wrapper",{styles:{display:"none"},className:i}),this.modalWrapper.addEventListener("click",(function(e){e.target.id===n.modalWrapper.id&&n.closeOutside&&n.hide()})),this.modalWrapper}function le(){return this.modalContent=J(this,Y,re).call(this,"div","content",{className:"wallkit-modal-wrapper__content"}),this.modalContent.style.minWidth="500px",this.modalContent.style.minHeight="250px",this.modalContent}function ce(){var e;this.loaderElement=J(this,Y,re).call(this,"div","wallkit-modal-spinner",{className:"wallkit-spinner",styles:{display:null!==(e=this.options)&&void 0!==e&&e.initialLoader?"flex":"none"}}),this.loaderElement.insertAdjacentHTML("beforeend",'<div class="wallkit-spinner__container"><div class="cube1"></div><div class="cube2"></div></div>')}function ue(){return J(this,ne,he).call(this),this.modalWrapper.appendChild(this.modalContent),this.modalContent.appendChild(this.loaderElement),this.modalContent.appendChild(J(this,Z,ae).call(this)),this.modalFrame?this.insertContent(this.modalFrame.init()):this.modalContent&&this.insertContent(this.content),y(this.modalWrapper)}function he(){!function(e,n,i){var o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];switch(e){case"css":var r=i;return r+=o?".min.css":".css",void m("".concat(t,"/css/").concat(n,"/").concat(r),"wk-css-".concat(i));default:;}}("css","1.0","spinner")}function fe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function de(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fe(Object(n),!0).forEach((function(t){pe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function pe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ve(e){return(ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function me(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function be(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}var we=new WeakSet,ye=new WeakSet,ke=function(){function e(t){var n,i,o,a,s;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),ye.add(this),we.add(this),this.config=null==t?void 0:t.config,this.providers=null==t?void 0:t.providers,this.tosURL=null==t?void 0:t.tosURL,this.privacyPolicyURL=null==t?void 0:t.privacyPolicyURL,this.captchaKey=null!==(n=null==t?void 0:t.captchaKey)&&void 0!==n?n:"6LeNZrwbAAAAAKXPTmJj5KMdUwI2GE6XAUbCU6DM",this.firebase=null,this.firebaseui=null,this.elementPlaceholder=null!==(i=null==t?void 0:t.elementSelector)&&void 0!==i?i:"#".concat(r),this.onSuccessAuth=null!==(o=null==t?void 0:t.onSuccessAuth)&&void 0!==o?o:null,this.onAuthStateChanged=null!==(a=null==t?void 0:t.onAuthStateChanged)&&void 0!==a?a:null,this.uiShown=null!==(s=null==t?void 0:t.uiShown)&&void 0!==s?s:null}var t,n;return t=e,(n=[{key:"allowedProviders",get:function(){return{google:this.firebase.auth.GoogleAuthProvider.PROVIDER_ID,email:this.firebase.auth.EmailAuthProvider.PROVIDER_ID,facebook:this.firebase.auth.FacebookAuthProvider.PROVIDER_ID,apple:"apple.com",microsoft:"microsoft.com"}}},{key:"formatSelectedProviders",value:function(e){var t=this,n=[];return Array.isArray(e)&&(n=e.map((function(e){if("object"===ve(e)){if(t.allowedProviders[e.provider])return de(de({},e),{},{provider:t.allowedProviders[e.provider]})}else if(t.allowedProviders[e])return t.allowedProviders[e]})).filter((function(e){return!!e}))),n}},{key:"initFirebase",value:function(e){var t=this,n=e.config,i=e.providers,o=void 0===i?["email","google"]:i,r=e.tosUrl,a=void 0===r?"https://wallkit.net":r,l=e.privacyPolicyUrl,c=void 0===l?"https://wallkit.net":l;this.firebase.initializeApp(null!=n?n:s),this.captchaKey&&this.firebase.appCheck().activate(this.captchaKey,!0);var u=new this.firebaseui.auth.AuthUI(this.firebase.auth());u.disableAutoSignIn();var h={callbacks:{signInSuccessWithAuthResult:function(e){e.user.getIdToken().then((function(n){var i={user:e.user,userId:e.user.uid,token:n};t.onSuccessAuth&&t.onSuccessAuth(i,e)}))},uiShown:function(){t.uiShown&&t.uiShown()}},signInFlow:"popup",signInOptions:this.formatSelectedProviders(o),credentialHelper:this.firebaseui.auth.CredentialHelper.GOOGLE_YOLO,tosUrl:a,privacyPolicyUrl:c};u.start(this.elementPlaceholder,h),this.firebaseui=u,this.firebase.auth().onAuthStateChanged(be(this,ye,Oe).bind(this))}},{key:"reset",value:function(){this.firebaseui&&(this.firebaseui.reset(),this.firebaseui.start(this.elementPlaceholder))}},{key:"logout",value:function(){var e=this;return new Promise((function(t){e.firebase&&e.firebase.auth?e.firebase.auth().signOut().then((function(){return t(!0)})):t(!1)}))}},{key:"authWithCustomToken",value:function(e){var t=this;return new Promise((function(n){t.firebase&&t.firebase.auth&&t.firebase.auth().signInWithCustomToken(e).then((function(e){n(e)})).catch((function(){console.log("Custom Token Auth Fail"),n(!1)})),n(!1)}))}},{key:"init",value:function(){var e=this;be(this,we,ge).call(this).then((function(){e.initFirebase({config:e.config,providers:e.providers,tosUrl:e.tosURL,privacyPolicyUrl:e.privacyPolicyURL})}))}}])&&me(t.prototype,n),e}();function ge(){var e=this;return new Promise((function(t,n){b("https://www.gstatic.com/firebasejs/8.7.0/firebase-app.js","firebase-app",(function(){var n=[{url:"https://www.gstatic.com/firebasejs/8.7.0/firebase-analytics.js",id:"firebase-analytics",defer:!0,onload:function(){return o()}},{url:"https://www.gstatic.com/firebasejs/8.7.0/firebase-auth.js",id:"firebase-auth",defer:!0,onload:function(){return o()}},{url:"https://www.gstatic.com/firebasejs/8.7.0/firebase-firestore.js",id:"firebase-firestore",defer:!0,onload:function(){return o()}},{url:"https://www.gstatic.com/firebasejs/ui/4.8.0/firebase-ui-auth.js",id:"firebase-ui",defer:!0,onload:function(){return o()}},{url:"https://www.gstatic.com/firebasejs/8.7.0/firebase-app-check.js",id:"firebase-app-check",defer:!0,onload:function(){return o()}}],i=0,o=function(){++i===n.length&&(e.firebase=window.firebase,e.firebaseui=window.firebaseui,t({firebase:window.firebase,firebaseui:window.firebaseui}))};(function(e){Array.isArray(e)&&e.forEach((function(e){b(e.url,e.id,e.onload)}))})(n),m("https://www.gstatic.com/firebasejs/ui/4.8.0/firebase-ui-auth.css","firebase-ui-styles")}))}))}function Oe(e){var t=this;e&&e.getIdToken().then((function(e){t.onAuthStateChanged&&t.onAuthStateChanged(e)}))}function Ee(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Te=new WeakSet,je=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Te.add(this),e.instance)return e.instance;e.instance=this,this.currentFrameName="",this.options=t,this.frameElement=null,this.ready=!1,this.events=new E}var t,n;return t=e,(n=[{key:"element",get:function(){return this.frameElement}},{key:"getFrameURL",get:function(){return"".concat("https://wallkit.net/popups","?PUBLIC_KEY=").concat(this.options.public_key,"&version=").concat(this.options.version)}},{key:"createFrame",value:function(){return this.frameElement=p("iframe",{id:a,className:a,attributes:{scrolling:"no",allowtransparency:"true",frameborder:"0",width:i,height:o}}),this.frameElement.setAttribute("src",this.getFrameURL),this.events.notify(T,!0),this.frameElement}},{key:"resize",value:function(e,t){e=e>=i?e:i,t=t>=o?t:o,this.frameElement&&(this.frameElement.width=e,this.frameElement.height=t)}},{key:"sendEvent",value:function(e,t,n){if(this.frameElement&&this.frameElement.contentWindow){var i=this.frameElement.contentWindow;this.events.notify(e,t),i.postMessage({name:e,value:t,params:n},"*")}}},{key:"openFrame",value:function(e,t){var n=this;this.currentFrameName=e,this.ready?this.sendEvent(A,e,t):this.events.subscribe(W,(function(){n.sendEvent(A,e,t)}),{once:!0})}},{key:"onFrameReady",value:function(){var e,t;this.ready=!0,null!==(e=this.options)&&void 0!==e&&e.onReady&&(null===(t=this.options)||void 0===t||t.onReady())}},{key:"init",value:function(){return function(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}(this,Te,Re).call(this),this.createFrame()}}])&&Ee(t.prototype,n),e}();function Re(){var e=this;this.events.subscribe(L,(function(t){e.currentFrameName=t})),this.events.subscribe(W,(function(t){!0===t&&e.onFrameReady()}))}function Se(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Pe(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,Ae(e,t,"get"))}function Ce(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,Ae(e,t,"set"),n),n}function Ae(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var We=new WeakMap,Le=new WeakMap,Ie=function(){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),We.set(this,{writable:!0,value:void 0}),Le.set(this,{writable:!0,value:void 0}),t.instance?t.instance:e?(t.instance=this,this.methods=null,this.client=null,Ce(this,We,e),Ce(this,Le,new E),void(window.Wallkit?this.onLoad():this.load())):new Error("No Options Provided")}var n,i;return n=t,(i=[{key:"onLoad",value:function(){var e,t;window.Wallkit&&(window.Wallkit.init({resource:Pe(this,We).public_key}),this.methods=window.Wallkit,this.client=window.Wallkit.client,Pe(this,Le).notify(R,window.Wallkit),null!==(e=Pe(this,We))&&void 0!==e&&e.onLoaded&&(null===(t=Pe(this,We))||void 0===t||t.onLoaded()))}},{key:"awaitLoad",value:function(){var e=this;return new Promise((function(t){e.methods?t(e):Pe(e,Le).subscribe(R,(function(){return t(e)}))}))}},{key:"load",value:function(){b("".concat(e,"/js/sdk/0.0.41/wallkit.umd.min.js"),"wallkit-js-sdk",this.onLoad.bind(this))}}])&&Se(n.prototype,i),t}();const _e={setItem:function(e,t){return this.isAvailable()?window.localStorage.setItem(e,t):null},getItem:function(e){return this.isAvailable()?window.localStorage.getItem(e):null},removeItem:function(e){if(this.isAvailable())return window.localStorage.removeItem(e)},isAvailable:function(){try{return window.localStorage.setItem("",""),window.localStorage.removeItem(""),!0}catch(e){return!1}}};function xe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function De(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,Me(e,t,"get"))}function Me(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var Fe=new WeakMap,Ue=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Fe.set(this,{writable:!0,value:void 0}),t&&(function(e,t,n){(function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}})(e,Me(e,t,"set"),n)}(this,Fe,t),n?this.set(n):this.token=this.getStoredTokenValue()||null)}var t,n;return t=e,(n=[{key:"get",value:function(){return this.token}},{key:"getStoredTokenValue",value:function(){return _e.getItem(De(this,Fe))||null}},{key:"remove",value:function(){var e;this.token=null,e=De(this,Fe),document.cookie="".concat(e,"=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;"),_e.removeItem(De(this,Fe))}},{key:"set",value:function(e){this.token=e,function(e,t,n){var i=(n=n||{}).expires;if("number"==typeof i&&i){var o=new Date;o.setTime(o.getTime()+1e3*i),i=n.expires=o}i&&i.toUTCString&&(n.expires=i.toUTCString()),t=encodeURIComponent(t);var r="".concat(e,"=").concat(t);for(var a in n){r+="; "+a;var s=n[a];s&&(r+="="+s)}document.cookie=r}(De(this,Fe),e,{expires:"Fri, 31 Dec 9999 23:59:59 GMT",path:"/"}),_e.setItem(De(this,Fe),e)}}])&&xe(t.prototype,n),e}();function Ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function ze(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ne(Object(n),!0).forEach((function(t){Ge(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ge(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function He(e){return(He="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ke(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,Ve(e,t,"get"))}function Be(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}function Ve(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var Je=new WeakMap,Xe=new WeakSet,Ye=new WeakSet,Ze=new WeakSet,$e=new WeakSet,Qe=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),$e.add(this),Ze.add(this),Ye.add(this),Xe.add(this),Je.set(this,{writable:!0,value:void 0}),e.instance)return e.instance;if(e.instance=this,o=t,function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(i=this,Ve(i,Je,"set"),o),this.token=new Ue("wk-token"),this.firebaseToken=new Ue("firebase-token"),this.frame=new je,this.sdk=new Ie,null!=t&&t.firebase){this.modal=Be(this,Xe,et).call(this),this.modal.init();var n={onAuthStateChanged:this.updateFirebaseToken.bind(this),onSuccessAuth:this.onSuccessAuth.bind(this),uiShown:this.onFirebaseInit.bind(this),onAuthFail:this.onFirebaseAuthFail.bind(this)};"object"===He(t.firebase)&&(n=ze(ze({},n),t.firebase)),this.firebase=new ke(n),this.firebase.init()}var i,o;this.events=new E}var t,n;return t=e,(n=[{key:"isAuthenticated",value:function(){return this.sdk?this.sdk.methods.isAuthenticated():!!this.token.get()}},{key:"onSuccessAuth",value:function(e){var t=this;this.modal.toggleLoader(!0),this.updateFirebaseToken(e.token),this.events.notify(_,e),this.authInWallkit(e.token).then((function(e){e?t.modal.hide():t.firebase.reset(),t.modal.toggleLoader(!1)}))}},{key:"authInWallkit",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return Be(this,$e,it).call(this),new Promise((function(n){t?e.sdk.methods.authenticateWithFirebase(t).then((function(t){var i=t.token,o=t.existed;e.setToken(i);var r=setTimeout((function(){n(!1)}),1e4);e.sdk.methods.subscribeLocalEvent("user",(function t(){clearTimeout(r),e.sdk.methods.unsubscribeLocalEvent("user",t),e.events.notify(I,{register:!o}),n(!0)}))})).catch((function(t){var i;Be(e,Ze,nt).call(e,null==t||null===(i=t.response)||void 0===i?void 0:i.error_description),e.removeTokens(),n(!1)})):n(!1)}))}},{key:"show",value:function(){this.modal.show()}},{key:"updateFirebaseToken",value:function(e){this.firebaseToken.set(e),this.frame.sendEvent(F,e)}},{key:"onFirebaseInit",value:function(){this.modal.toggleLoader(!1)}},{key:"removeToken",value:function(){this.token.remove()}},{key:"removeFirebaseToken",value:function(){this.firebaseToken.remove()}},{key:"removeTokens",value:function(){this.removeToken(),this.removeFirebaseToken()}},{key:"setToken",value:function(e){this.token.set(e)}},{key:"logout",value:function(){var e=this;this.removeToken(),this.firebase.logout().then((function(t){t&&e.removeFirebaseToken()})),this.firebase.reset()}},{key:"dispatchTokens",value:function(){this.isAuthenticated()&&(this.token.get()&&this.frame.sendEvent(U,this.token.get()),this.firebaseToken.get()&&this.frame.sendEvent(F,this.firebaseToken.get()))}},{key:"onFirebaseAuthFail",value:function(e){this.modal.toggleLoader(!1)}},{key:"handleOneTapResponse",value:function(e){var t=e.credential;this.frame.sendEvent(H,t)}},{key:"init",value:function(){Be(this,Ye,tt).call(this)}}])&&qe(t.prototype,n),e}();function et(){var e,t,n,i='<div>\n                                        <h2 class="wallkit-auth-modal__title">'.concat(null!==(e=null===(t=Ke(this,Je))||void 0===t?void 0:t.modalTitle)&&void 0!==e?e:"Sign In",'</h2>\n                                        <div id="').concat(r,'"></div>\n                                     </div>');return new ie({modalName:"auth-modal",content:(null===(n=Ke(this,Je))||void 0===n?void 0:n.content)||i,className:"wallkit-auth-modal",initialLoader:!0})}function tt(){var e=this;this.events.subscribe(x,(function(t){var n=t.name,i=t.value;switch(n){case z:case G:case N:case U:if(i){var o=i.token;e.setToken(o)}break;case M:e.firebaseToken.set(i),e.sdk&&e.sdk.methods.setFirebaseToken(i);break;case q:i&&e.firebase.authWithCustomToken(i);break;case D:e.logout()}}))}function nt(e){var t=document.getElementById("authorization-error");t&&(t.innerHTML=e||"")}function it(){Be(this,Ze,nt).call(this,null)}function ot(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function rt(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,st(e,t,"get"))}function at(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,st(e,t,"set"),n),n}function st(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var lt=new WeakMap,ct=new WeakMap,ut=new WeakMap,ht=new WeakMap,ft=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),lt.set(this,{writable:!0,value:void 0}),ct.set(this,{writable:!0,value:void 0}),ut.set(this,{writable:!0,value:void 0}),ht.set(this,{writable:!0,value:void 0}),at(this,lt,{parseUTM:void 0===(null==t?void 0:t.parseUTM)||t.parseUTM}),at(this,ut,new Qe),at(this,ct,new Ie),at(this,ht,new E),this.utmTags={}}var t,n;return t=e,(n=[{key:"parseUTMTags",value:function(){var e=this;if(!window.location.search.includes("utm"))return{};var t=new URLSearchParams(window.location.search),n={};return["utm_source","utm_medium","utm_campaign"].forEach((function(e){t.get(e)&&(n[e]=t.get(e))})),this.utmTags=n,rt(this,ut).isAuthenticated()?rt(this,ct).methods.updateUser({extra:this.utmTags}):this.hasUTMTags&&rt(this,ht).subscribe(j,(function(){rt(e,ct).methods.updateUser({extra:e.utmTags})}),{once:!0}),n}},{key:"hasUTMTags",get:function(){return!!Object.keys(this.utmTags).length}},{key:"init",value:function(){!1!==rt(this,lt).parseUTM&&this.parseUTMTags()}}])&&ot(t.prototype,n),e}();function dt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function pt(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}var vt,mt,bt=new WeakMap,wt=new WeakSet,yt=new WeakSet,kt=function(){function e(t,n){var i,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),yt.add(this),wt.add(this),bt.set(this,{writable:!0,value:void 0}),this.content=t,o=n,function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(i=this,function(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.get(e)}(i,bt),o),this.sdk=new Ie,this.accessCount=0,this.accessCountLimit=0}var t,n;return t=e,(n=[{key:"formatTaxonomies",value:function(e){var t={},n=[],i=[],o=function(o){var r;i.push(o),n.push(e[o].label);var a="term_keys[".concat(o,"]"),s="term_titles[".concat(o,"]"),l=t[a],c=t[s];null!==(r=e[o])&&void 0!==r&&r.items&&e[o].items.forEach((function(e){l?l.push(e.slug):t[a]=[e.slug],c?c.push(e.slug):t[s]=[e.name]})),t[a]=t[a].join(","),t[s]=t[s].join(",")};for(var r in e)o(r);return t.taxonomy_titles=n.join(","),t.taxonomy_keys=i.join(","),t}},{key:"checkContentAccessAndSync",value:function(e){var t=this,n={type:e.type,title:e.title,link:e.link||window.location.href,image:e.image||null};return Object.assign(n,this.formatTaxonomies(e.taxonomies)),this.sdk.client.get({path:pt(this,yt,Ot).call(this,e.id,n)}).then((function(n){return t.sdk.methods.isAuthenticated()&&t.getAccessDetails(e.id),{allowed:n.allow,data:n}})).catch((function(e){return{allowed:!1,error:e}}))}},{key:"checkAccess",value:function(){var e=this;return this.sdk.methods.checkAccess(this.content.id).then((function(t){return e.sdk.methods.isAuthenticated()&&e.getAccessDetails(e.content.id),{allowed:t.allow,data:t}})).catch((function(t){return"incorrect_content_key"===t.error?e.checkContentAccessAndSync(e.content):{allowed:!1,error:t}}))}},{key:"getAccessDetails",value:function(e){var t=this;return this.sdk.client.get({path:"/user/content-access-details/".concat(e)}).then((function(e){if(e){var n=e.content_terms;return t.accessCount=n.usedLimitInPeriod,t.accessCountLimit=n.accessLimit,{accessCount:t.accessCount,accessCountLimit:t.accessCountLimit}}return{accessCount:0,accessCountLimit:0}})).catch((function(e){return e}))}}])&&dt(t.prototype,n),e}();function gt(e){var t=[];for(var n in e)void 0!==e[n]&&t.push("".concat(encodeURIComponent(n),"=").concat(encodeURIComponent(e[n])));return t.join("&")}function Ot(e,t){var n=pt(this,wt,gt).call(this,t);return"/user/content-sync-and-check/".concat(e,"?").concat(n)}function Et(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Tt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Et(Object(n),!0).forEach((function(t){jt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Et(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function jt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Rt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function St(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}function Pt(){var e=this;window.addEventListener("message",(function(t){var i=t.data,o=i.value,r=i.name,a=t.origin;e.events.notify(r,o),e.events.notify(S,{name:r,value:o});try{if(n.includes(a)&&r)switch(r){case"wk-event-modals-ready":e.authentication.isAuthenticated()?e.frame.sendEvent("wk-event-applepay-ready",function(){try{return!!window.ApplePaySession&&window.ApplePaySession.canMakePayments()}catch(e){return console.error("ApplePay Error",e),!1}}()):e.frame.sendEvent("wk-event-get-token",e.config.public_key);break;case"wk-event-resize":0!==o.width&&0!==o.height&&e.popup.resize(o.width,o.height);break;case"show-firebase-auth":var s=o;e.popup.hide(),e.events.subscribe(j,(function(){s&&e.popup.open(s)}),{once:!0}),e.authentication.show();break;case"wk-event-close-modal":e.popup.hide();break;case"wk-event-reload-page":e.popup.hide(),location.reload();break;case"wk-event-storage-available":o||e.authentication.dispatchTokens();break;case"wk-event-close-on-wrapper":e.popup.closeOutside=o}}catch(e){console.log("ERROR",e)}}))}function Ct(){var e,t=p("style");t.innerHTML="\n        .wallkit-modal-wrapper {\n            z-index: 100;\n            position: fixed;\n            top: 0;\n            left: 0;\n            right: 0;\n            bottom: 0;\n            background: rgba(18, 18, 20, 0.9);\n            display: flex;\n            align-items: center;\n            justify-content: flex-start;\n            flex-direction: column;\n            overflow-y: auto;\n            padding: 70px 15px 20px;\n        }\n\n        .wallkit-modal-wrapper__content {\n            background-color: #fff;\n            flex-shrink: 0;\n            position: relative;\n            box-sizing: border-box;\n            overflow: hidden;\n        }\n        \n        @media screen and (max-width: 500px) {\n            .wallkit-modal-wrapper__content {\n                width: 100%;\n                min-width: auto!important;\n            }\n        }\n\n        .wallkit-modal-wrapper__close-btn {\n            position: absolute;\n            right: 10px;\n            top: 10px;\n            cursor: pointer;\n            color: #000;\n            font-size: 37px;\n            width: 37px;\n            height: 37px;\n            text-align: center;\n            line-height: 34px;\n        }\n\n        .wallkit-modal-wrapper .wk-frame {\n            transition: all 0.3s linear 0s;\n            max-width: 100%;\n            border: none;\n        }\n\n        .wallkit-auth-modal {\n            z-index: 999;\n        }\n\n        .wallkit-auth-modal .wallkit-modal-wrapper__content {\n            padding: 20px;\n        }\n\n        .wallkit-auth-modal .wallkit-auth-modal__title {\n            font-family: Roboto, sans-serif;\n            text-align: center;\n        }\n\n        button:focus {\n            background-color: #000;\n        }\n",e=t,f()?e?document.head.appendChild(e):h.checkRequiredArgument(e,"element"):h.handleError("Document is not available",c.DOM_ERROR)}window.WallkitIntegration=(vt=new WeakSet,mt=new WeakSet,function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),mt.add(this),vt.add(this),this.config=t,this.events=new E,this.frame=new je(Tt(Tt({},t),{},{onReady:function(){return n.popup.toggleLoader(!1)}})),this.popup=new ie({resourceFrame:this.frame,initialLoader:!0,onReady:function(e){e.openByHash()},onClose:function(){n.events.notify(P,{name:n.frame.currentFrameName})}}),this.content=kt,this.sdk=new Ie(Tt(Tt({},t),{},{onLoaded:function(){var e,i,o,r,a;n.authentication=new Qe({firebase:null==t||null===(e=t.auth)||void 0===e?void 0:e.firebase,modalTitle:null===(i=t.auth)||void 0===i||null===(o=i.modal)||void 0===o?void 0:o.title,content:null===(r=t.auth)||void 0===r||null===(a=r.modal)||void 0===a?void 0:a.content}),n.analytics=new ft(null==t?void 0:t.analytics),n.init()}}))}var t,n;return t=e,(n=[{key:"modal",value:function(e,t){this.popup.open(e,t)}},{key:"init",value:function(){St(this,mt,Ct).call(this),this.popup.init(),this.authentication.init(),this.analytics.init(),St(this,vt,Pt).call(this),this.config.onInit&&this.config.onInit()}}])&&Rt(t.prototype,n),e}()),WallkitIntegration})();