(()=>{"use strict";var e="https://cdn.wallkit.net",t=e+"/assets",n=[document.location.origin,"http://127.0.0.1:8000","https://wallkit.net","https://dev.wallkit.net","https://demo.wallkit.net"],i="500",o="250",r="firebase-ui-placeholder",a="wk-frame",s={apiKey:"AIzaSyAoRdxZIlUE0HInqtzDid6rNxluhs5nCqg",authDomain:"wallkit-production.firebaseapp.com",databaseURL:"https://wallkit-production.firebaseio.com",projectId:"wallkit-production",storageBucket:"wallkit-production.appspot.com",messagingSenderId:"779443518820",appId:"1:779443518820:web:ffc6660647590674e20e71",measurementId:"G-GWJ1GC5B30"};function l(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var u={DOM_ERROR:"DOM_ERROR",ARGUMENT_ERROR:"ARGUMENT_ERROR"},c={DOM_ERROR:"DOM Manipulation gone wrong",ARGUMENT_ERROR:"One of the argument were not provided"},h=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,n=[{key:"isErrorRecognisable",value:function(e){return!!u[e]}},{key:"getErrorTypeMessage",value:function(e){var t;return null!==(t=c[e])&&void 0!==t?t:"Unrecognised Error"}},{key:"handleError",value:function(t,n){if(n&&this.isErrorRecognisable(n)){var i=null!=t?t:e.getErrorTypeMessage(n),o="ERROR::".concat(n,"; ").concat(i,";");throw console.log(o),new e(o)}var r="ERROR::".concat(n,";");throw console.log(r),new e(r)}},{key:"checkRequiredArgument",value:function(e,t){void 0===e&&this.handleError("Argument ".concat(t," is not provided"),u.ARGUMENT_ERROR)}}],null&&l(t.prototype,null),n&&l(t,n),e}(),f=function(){return!!document},d=function(e){return f()?!!document.querySelector(e):h.handleError("Document is not available",u.DOM_ERROR)},p=function(e,t){if(!f())return h.handleError("Document is not available",u.DOM_ERROR);if(!e)return h.checkRequiredArgument(e);var n=document.createElement(e),i=null!=t?t:{},o=i.id,r=i.className,a=i.styles,s=i.attributes;if(o&&(n.id=o),r&&n.setAttribute("class",r),a&&Object.keys(a)&&Object.keys(a).length)for(var l in a)a.hasOwnProperty(l)&&(n.style[l]=a[l]);if(s&&Object.keys(s)&&Object.keys(s).length)for(var c in s)s.hasOwnProperty(c)&&(n[c]=s[c]);return n},v=function(e){return f()?e?document.body.appendChild(e):h.checkRequiredArgument(e,"element"):h.handleError("Document is not available",u.DOM_ERROR)},m=function(e,t){if(!f())return h.handleError("Document is not available",u.DOM_ERROR);if(!d("#"+t)){var n=document.querySelector("head"),i=document.createElement("link");return t&&(i.id=t),i.rel="stylesheet",i.type="text/css",i.href=e,i.media="all",n.appendChild(i)}},b=function(e,t,n){if(!f())return h.handleError("Document is not available",u.DOM_ERROR);if(!d("#"+t)){var i=p("script",{id:t,attributes:{src:e}});return n&&i.addEventListener("load",n,{once:!0}),v(i)}};const w=p,y=v,k=d;function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function O(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var E=function(){function e(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),e.instance?e.instance:(e.instance=this,this.listeners=[],this)}var t,n;return t=e,(n=[{key:"subscribe",value:function(e,t,n){this.listeners.push({name:e,callback:t,options:n})}},{key:"unsubscribe",value:function(e,t){this.listeners=this.listeners.filter((function(n){return n.name!==e&&n.callback!==t}))}},{key:"notify",value:function(e,t){var n=this;this.listeners.forEach((function(i,o){var r;e===i.name&&(i.callback(t),null!=i&&null!==(r=i.options)&&void 0!==r&&r.once&&n.listeners.splice(o,1))}))}}])&&O(t.prototype,n),e}(),R="frame-created",j="success-auth",P="wallkit-js-sdk-loaded",T="frame-message",S="frame-modal-closed",A="modal-closed",C="wk-event-modal",W="wk-event-modals-ready",D="wk-event-route-change";const F=j,I="success-firebase-auth",L=T,M="wk-event-logout",_="wk-firebase-token",x="wk-event-firebase-token",U="wk-event-token",N="wk-event-get-token",z="wk-event-auth",G="wk-event-registration",H="wk-event-one-tap-sign-in";function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function B(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function V(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function J(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}var K=new WeakSet,Y=new WeakSet,Z=new WeakSet,$=new WeakSet,Q=new WeakSet,X=new WeakSet,ee=new WeakSet,te=new WeakSet,ne=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),te.add(this),ee.add(this),X.add(this),Q.add(this),$.add(this),Z.add(this),Y.add(this),K.add(this),this.options=t,this.modalFrame=t?t.resourceFrame:null,this.content=t?t.content:null,this.modalWrapper=null,this.modalContent=null,this.loaderElement=null,this.isLoading=!1,this.closeOutside=!0,this.onClose=t?t.onClose:null}var t,n;return t=e,(n=[{key:"bindCloseEvent",value:function(e){return e.addEventListener("click",this.hide.bind(this))}},{key:"insertContent",value:function(e){this.modalContent&&e&&("string"==typeof e?this.modalContent.insertAdjacentHTML("beforeend",e):e instanceof HTMLElement&&this.modalContent.appendChild(e))}},{key:"toggleLoader",value:function(e){this.isLoading=e,this.loaderElement.style.display=e?"flex":"none"}},{key:"open",value:function(e,t){this.modalFrame&&(this.modalFrame.openFrame(e,t),this.show())}},{key:"destroy",value:function(){}},{key:"show",value:function(){this.modalWrapper.style.display="flex"}},{key:"hide",value:function(){(new E).notify(A,{name:J(this,K,ie).call(this)}),this.onClose&&this.onClose(),this.modalWrapper.style.display="none"}},{key:"resize",value:function(e,t){this.modalFrame&&this.modalFrame.resize(e,t)}},{key:"sendEvent",value:function(e,t,n){this.modalFrame&&this.modalFrame.sendEvent(e,t,n)}},{key:"openByHash",value:function(){var e=function(){var e=/#WkModal\((.*)\)$/.exec(decodeURIComponent(window.location.hash));if(e&&e[1]){var t=e[1].split(/,(.+)/);if(void 0!==t[1])try{t[1]=JSON.parse(t[1])}catch(e){t[1]={value:t[1].trim()}}return window.location.hash="",{name:t[0],params:"object"===g(t[1])?t[1]:null}}}();e&&this.open(e.name,e.params)}},{key:"onReady",value:function(){var e;null!==(e=this.options)&&void 0!==e&&e.onReady&&this.options.onReady(this)}},{key:"init",value:function(){J(this,$,ae).call(this),J(this,Q,se).call(this),J(this,X,le).call(this),J(this,ee,ue).call(this),this.onReady()}}])&&V(t.prototype,n),e}();function ie(){var e,t;return null!==(e=null===(t=this.options)||void 0===t?void 0:t.modalName)&&void 0!==e?e:"wk-modal"}function oe(e,t,n){for(var i=J(this,K,ie).call(this)+"-"+t,o=0,r=i;k("#"+r);)r=i+"-"+ ++o;return w(e,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q(Object(n),!0).forEach((function(t){B(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({id:r},n))}function re(){var e=J(this,Y,oe).call(this,"div","close-btn",{className:"wallkit-modal-wrapper__close-btn"});return e.innerHTML="&#xd7;",this.bindCloseEvent(e),e}function ae(){var e,t,n=this,i="wallkit-modal-wrapper";return null!==(e=this.options)&&void 0!==e&&e.className&&(i+=" "+(null===(t=this.options)||void 0===t?void 0:t.className)),this.modalWrapper=J(this,Y,oe).call(this,"div","wrapper",{styles:{display:"none"},className:i}),this.modalWrapper.addEventListener("click",(function(e){e.target.id===n.modalWrapper.id&&n.closeOutside&&n.hide()})),this.modalWrapper}function se(){return this.modalContent=J(this,Y,oe).call(this,"div","content",{className:"wallkit-modal-wrapper__content"}),this.modalContent.style.minWidth="500px",this.modalContent.style.minHeight="250px",this.modalContent}function le(){var e;this.loaderElement=J(this,Y,oe).call(this,"div","wallkit-modal-spinner",{className:"wallkit-spinner",styles:{display:null!==(e=this.options)&&void 0!==e&&e.initialLoader?"flex":"none"}}),this.loaderElement.insertAdjacentHTML("beforeend",'<div class="wallkit-spinner__container"><div class="cube1"></div><div class="cube2"></div></div>')}function ue(){return J(this,te,ce).call(this),this.modalWrapper.appendChild(this.modalContent),this.modalContent.appendChild(this.loaderElement),this.modalContent.appendChild(J(this,Z,re).call(this)),this.modalFrame?this.insertContent(this.modalFrame.init()):this.modalContent&&this.insertContent(this.content),y(this.modalWrapper)}function ce(){!function(e,n,i){var o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];switch(e){case"css":var r=i;return r+=o?".min.css":".css",void m("".concat(t,"/css/").concat(n,"/").concat(r),"wk-css-".concat(i));default:;}}("css","1.0","spinner")}function he(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?he(Object(n),!0).forEach((function(t){de(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):he(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function de(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pe(e){return(pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ve(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function me(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}var be=new WeakSet,we=new WeakSet,ye=function(){function e(t){var n,i,o,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),we.add(this),be.add(this),this.config=null==t?void 0:t.config,this.providers=null==t?void 0:t.providers,this.tosURL=null==t?void 0:t.tosURL,this.privacyPolicyURL=null==t?void 0:t.privacyPolicyURL,this.firebase=null,this.firebaseui=null,this.elementPlaceholder=null!==(n=null==t?void 0:t.elementSelector)&&void 0!==n?n:"#".concat(r),this.onSuccessAuth=null!==(i=null==t?void 0:t.onSuccessAuth)&&void 0!==i?i:null,this.onAuthStateChanged=null!==(o=null==t?void 0:t.onAuthStateChanged)&&void 0!==o?o:null,this.uiShown=null!==(a=null==t?void 0:t.uiShown)&&void 0!==a?a:null}var t,n;return t=e,(n=[{key:"allowedProviders",get:function(){return{google:this.firebase.auth.GoogleAuthProvider.PROVIDER_ID,email:this.firebase.auth.EmailAuthProvider.PROVIDER_ID,facebook:this.firebase.auth.FacebookAuthProvider.PROVIDER_ID,apple:"apple.com",microsoft:"microsoft.com"}}},{key:"formatSelectedProviders",value:function(e){var t=this,n=[];return Array.isArray(e)&&(n=e.map((function(e){if("object"===pe(e)){if(t.allowedProviders[e.provider])return fe(fe({},e),{},{provider:t.allowedProviders[e.provider]})}else if(t.allowedProviders[e])return t.allowedProviders[e]})).filter((function(e){return!!e}))),n}},{key:"initFirebase",value:function(e){var t=this,n=e.config,i=e.providers,o=void 0===i?["email","google"]:i,r=e.tosUrl,a=void 0===r?"https://wallkit.net":r,l=e.privacyPolicyUrl,u=void 0===l?"https://wallkit.net":l;this.firebase.initializeApp(null!=n?n:s);var c=new this.firebaseui.auth.AuthUI(this.firebase.auth());c.disableAutoSignIn();var h={callbacks:{signInSuccessWithAuthResult:function(e){e.user.getIdToken().then((function(n){var i={user:e.user,userId:e.user.uid,token:n};t.onSuccessAuth&&t.onSuccessAuth(i,e)}))},uiShown:function(){t.uiShown&&t.uiShown()}},signInFlow:"popup",signInOptions:this.formatSelectedProviders(o),credentialHelper:this.firebaseui.auth.CredentialHelper.GOOGLE_YOLO,tosUrl:a,privacyPolicyUrl:u};c.start(this.elementPlaceholder,h),this.firebaseui=c,this.firebase.auth().onAuthStateChanged(me(this,we,ge).bind(this))}},{key:"reset",value:function(){this.firebaseui&&(this.firebaseui.reset(),this.firebaseui.start(this.elementPlaceholder))}},{key:"logout",value:function(){var e=this;return new Promise((function(t){e.firebase&&e.firebase.auth?e.firebase.auth().signOut().then((function(){return t(!0)})):t(!1)}))}},{key:"init",value:function(){var e=this;me(this,be,ke).call(this).then((function(){e.initFirebase({config:e.config,providers:e.providers,tosUrl:e.tosURL,privacyPolicyUrl:e.privacyPolicyURL})}))}}])&&ve(t.prototype,n),e}();function ke(){var e=this;return new Promise((function(t,n){b("https://www.gstatic.com/firebasejs/8.7.0/firebase-app.js","firebase-app",(function(){var n=[{url:"https://www.gstatic.com/firebasejs/8.7.0/firebase-analytics.js",id:"firebase-analytics",defer:!0,onload:function(){return o()}},{url:"https://www.gstatic.com/firebasejs/8.7.0/firebase-auth.js",id:"firebase-auth",defer:!0,onload:function(){return o()}},{url:"https://www.gstatic.com/firebasejs/8.7.0/firebase-firestore.js",id:"firebase-firestore",defer:!0,onload:function(){return o()}},{url:"https://www.gstatic.com/firebasejs/ui/4.8.0/firebase-ui-auth.js",id:"firebase-ui",defer:!0,onload:function(){return o()}}],i=0,o=function(){++i===n.length&&(e.firebase=window.firebase,e.firebaseui=window.firebaseui,t({firebase:window.firebase,firebaseui:window.firebaseui}))};(function(e){Array.isArray(e)&&e.forEach((function(e){b(e.url,e.id,e.onload)}))})(n),m("https://www.gstatic.com/firebasejs/ui/4.8.0/firebase-ui-auth.css","firebase-ui-styles")}))}))}function ge(e){var t=this;e&&e.getIdToken().then((function(e){t.onAuthStateChanged&&t.onAuthStateChanged(e)}))}function Oe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Ee=new WeakSet,Re=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Ee.add(this),e.instance)return e.instance;e.instance=this,this.currentFrameName="",this.options=t,this.frameElement=null,this.ready=!1,this.events=new E}var t,n;return t=e,(n=[{key:"element",get:function(){return this.frameElement}},{key:"getFrameURL",get:function(){return"".concat("https://wallkit.net/popups","?PUBLIC_KEY=").concat(this.options.public_key,"&version=").concat(this.options.version)}},{key:"createFrame",value:function(){return this.frameElement=p("iframe",{id:a,className:a,attributes:{scrolling:"no",allowtransparency:"true",frameborder:"0",width:i,height:o}}),this.frameElement.setAttribute("src",this.getFrameURL),this.events.notify(R,!0),this.frameElement}},{key:"resize",value:function(e,t){e=e>=i?e:i,t=t>=o?t:o,this.frameElement&&(this.frameElement.width=e,this.frameElement.height=t)}},{key:"sendEvent",value:function(e,t,n){if(this.frameElement&&this.frameElement.contentWindow){var i=this.frameElement.contentWindow;this.events.notify(e,t),i.postMessage({name:e,value:t,params:n},"*")}}},{key:"openFrame",value:function(e,t){var n=this;this.currentFrameName=e,this.ready?this.sendEvent(C,e,t):this.events.subscribe(W,(function(){n.sendEvent(C,e,t)}),{once:!0})}},{key:"onFrameReady",value:function(){var e,t;this.ready=!0,null!==(e=this.options)&&void 0!==e&&e.onReady&&(null===(t=this.options)||void 0===t||t.onReady())}},{key:"init",value:function(){return function(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}(this,Ee,je).call(this),this.createFrame()}}])&&Oe(t.prototype,n),e}();function je(){var e=this;this.events.subscribe(D,(function(t){e.currentFrameName=t})),this.events.subscribe(W,(function(t){!0===t&&e.onFrameReady()}))}function Pe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Te(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,Ae(e,t,"get"))}function Se(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,Ae(e,t,"set"),n),n}function Ae(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var Ce=new WeakMap,We=new WeakMap,De=function(){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ce.set(this,{writable:!0,value:void 0}),We.set(this,{writable:!0,value:void 0}),t.instance?t.instance:e?(t.instance=this,this.methods=null,Se(this,Ce,e),Se(this,We,new E),void(window.Wallkit?this.onLoad():this.load())):new Error("No Options Provided")}var n,i;return n=t,(i=[{key:"onLoad",value:function(){var e,t;window.Wallkit&&(window.Wallkit.init({resource:Te(this,Ce).public_key}),this.methods=window.Wallkit,Te(this,We).notify(P,window.Wallkit),null!==(e=Te(this,Ce))&&void 0!==e&&e.onLoaded&&(null===(t=Te(this,Ce))||void 0===t||t.onLoaded()))}},{key:"awaitLoad",value:function(){var e=this;return new Promise((function(t){e.methods?t(e):Te(e,We).subscribe(P,(function(){return t(e)}))}))}},{key:"load",value:function(){b("".concat(e,"/js/sdk/0.0.41/wallkit.umd.min.js"),"wallkit-js-sdk",this.onLoad.bind(this))}}])&&Pe(n.prototype,i),t}();const Fe={setItem:function(e,t){return this.isAvailable()?window.localStorage.setItem(e,t):null},getItem:function(e){return this.isAvailable()?window.localStorage.getItem(e):null},removeItem:function(e){if(this.isAvailable())return window.localStorage.removeItem(e)},isAvailable:function(){try{return window.localStorage.setItem("",""),window.localStorage.removeItem(""),!0}catch(e){return!1}}};function Ie(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Le(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,Me(e,t,"get"))}function Me(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var _e=new WeakMap,xe=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),_e.set(this,{writable:!0,value:void 0}),t&&(function(e,t,n){(function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}})(e,Me(e,t,"set"),n)}(this,_e,t),n?this.set(n):this.token=this.getStoredTokenValue()||null)}var t,n;return t=e,(n=[{key:"get",value:function(){return this.token}},{key:"getStoredTokenValue",value:function(){return Fe.getItem(Le(this,_e))||null}},{key:"remove",value:function(){var e;this.token=null,e=Le(this,_e),document.cookie="".concat(e,"=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;"),Fe.removeItem(Le(this,_e))}},{key:"set",value:function(e){this.token=e,function(e,t,n){var i=(n=n||{}).expires;if("number"==typeof i&&i){var o=new Date;o.setTime(o.getTime()+1e3*i),i=n.expires=o}i&&i.toUTCString&&(n.expires=i.toUTCString()),t=encodeURIComponent(t);var r="".concat(e,"=").concat(t);for(var a in n){r+="; "+a;var s=n[a];s&&(r+="="+s)}document.cookie=r}(Le(this,_e),e,{expires:"Fri, 31 Dec 9999 23:59:59 GMT",path:"/"}),Fe.setItem(Le(this,_e),e)}}])&&Ie(t.prototype,n),e}();function Ue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ue(Object(n),!0).forEach((function(t){ze(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ue(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ze(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ge(e){return(Ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function He(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function qe(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,Ve(e,t,"get"))}function Be(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}function Ve(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var Je=new WeakMap,Ke=new WeakSet,Ye=new WeakSet,Ze=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Ye.add(this),Ke.add(this),Je.set(this,{writable:!0,value:void 0}),e.instance)return e.instance;if(e.instance=this,o=t,function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(i=this,Ve(i,Je,"set"),o),this.token=new xe("wk-token"),this.firebaseToken=new xe("firebase-token"),this.frame=new Re,this.sdk=new De,null!=t&&t.firebase){this.modal=Be(this,Ke,$e).call(this),this.modal.init();var n={onAuthStateChanged:this.updateFirebaseToken.bind(this),onSuccessAuth:this.onSuccessAuth.bind(this),uiShown:this.onFirebaseInit.bind(this),onAuthFail:this.onFirebaseAuthFail.bind(this)};console.log("options.firebase",t.firebase),"object"===Ge(t.firebase)&&(n=Ne(Ne({},n),t.firebase)),this.firebase=new ye(n),this.firebase.init()}var i,o;this.events=new E}var t,n;return t=e,(n=[{key:"isAuthenticated",value:function(){return this.sdk?this.sdk.methods.isAuthenticated():!!this.token.get()}},{key:"onSuccessAuth",value:function(e){var t=this;this.modal.toggleLoader(!0),this.updateFirebaseToken(e.token),this.events.notify(I,e),this.authInWallkit(e.token).then((function(e){e&&(t.modal.hide(),t.modal.toggleLoader(!1))}))}},{key:"authInWallkit",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return new Promise((function(n){t?e.sdk.methods.authenticateWithFirebase(t).then((function(t){var i=t.token,o=t.existed;e.setToken(i),e.events.notify(F,{register:!o}),n(!0)})):n(!1)}))}},{key:"show",value:function(){this.modal.show()}},{key:"updateFirebaseToken",value:function(e){this.firebaseToken.set(e),this.frame.sendEvent(x,e)}},{key:"onFirebaseInit",value:function(){this.modal.toggleLoader(!1)}},{key:"removeToken",value:function(){this.token.remove()}},{key:"removeFirebaseToken",value:function(){this.firebaseToken.remove()}},{key:"setToken",value:function(e){this.token.set(e)}},{key:"logout",value:function(){var e=this;this.removeToken(),this.firebase.logout().then((function(t){t&&e.removeFirebaseToken()}))}},{key:"dispatchTokens",value:function(){this.isAuthenticated()&&(this.token.get()&&this.frame.sendEvent(U,this.token.get()),this.firebaseToken.get()&&this.frame.sendEvent(x,this.firebaseToken.get()))}},{key:"onFirebaseAuthFail",value:function(e){this.modal.toggleLoader(!1)}},{key:"handleOneTapResponse",value:function(e){var t=e.credential;this.frame.sendEvent(H,t)}},{key:"init",value:function(){Be(this,Ye,Qe).call(this)}}])&&He(t.prototype,n),e}();function $e(){var e,t,n,i='<div>\n                                        <h2 class="wallkit-auth-modal__title">'.concat(null!==(e=null===(t=qe(this,Je))||void 0===t?void 0:t.modalTitle)&&void 0!==e?e:"Sign In",'</h2>\n                                        <div id="').concat(r,'"></div>\n                                     </div>');return new ne({modalName:"auth-modal",content:(null===(n=qe(this,Je))||void 0===n?void 0:n.content)||i,className:"wallkit-auth-modal",initialLoader:!0})}function Qe(){var e=this;this.events.subscribe(M,(function(){return e.logout()})),this.events.subscribe(_,(function(t){e.firebaseToken.set(t),e.sdk.methods.setFirebaseToken(t)})),this.events.subscribe(L,(function(t){var n=t.name,i=t.value;switch(n){case z:case G:case N:case U:if(i){var o=i.token;e.setToken(o)}}}))}function Xe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function et(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,nt(e,t,"get"))}function tt(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,nt(e,t,"set"),n),n}function nt(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var it,ot,rt=new WeakMap,at=new WeakMap,st=new WeakMap,lt=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),rt.set(this,{writable:!0,value:void 0}),at.set(this,{writable:!0,value:void 0}),st.set(this,{writable:!0,value:void 0}),tt(this,rt,{parseUTM:void 0===(null==t?void 0:t.parseUTM)||t.parseUTM}),tt(this,st,new Ze),tt(this,at,new De),this.utmTags={}}var t,n;return t=e,(n=[{key:"parseUTMTags",value:function(){if(!window.location.search.includes("utm"))return{};var e=new URLSearchParams(window.location.search),t={};return["utm_source","utm_medium","utm_campaign"].forEach((function(n){e.get(n)&&(t[n]=e.get(n))})),this.utmTags=t,et(this,st).isAuthenticated()&&et(this,at).methods.updateUser({extra:this.utmTags}),t}},{key:"hasUTMTags",get:function(){return!!Object.keys(this.utmTags).length}},{key:"init",value:function(){!1!==et(this,rt).parseUTM&&this.parseUTMTags()}}])&&Xe(t.prototype,n),e}();function ut(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function ct(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ut(Object(n),!0).forEach((function(t){ht(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ut(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ht(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ft(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function dt(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}function pt(){var e=this;window.addEventListener("message",(function(t){var i=t.data,o=i.value,r=i.name,a=t.origin;e.events.notify(r,o),e.events.notify(T,{name:r,value:o});try{if(n.includes(a)&&r)switch(r){case"wk-event-modals-ready":e.authentication.isAuthenticated()?e.frame.sendEvent("wk-event-applepay-ready",function(){try{return!!window.ApplePaySession&&window.ApplePaySession.canMakePayments()}catch(e){return console.error("ApplePay Error",e),!1}}()):e.frame.sendEvent("wk-event-get-token",e.config.public_key);break;case"wk-event-resize":0!==o.width&&0!==o.height&&e.popup.resize(o.width,o.height);break;case"show-firebase-auth":var s=o;e.authentication.show(),e.events.subscribe(j,(function(){console.log("redirect",s),s?e.popup.open(s):e.popup.hide()}),{once:!0});break;case"wk-event-close-modal":e.popup.hide();break;case"wk-event-reload-page":e.popup.hide(),location.reload();break;case"wk-event-storage-available":o||e.authentication.dispatchTokens();break;case"wk-event-close-on-wrapper":e.popup.closeOutside=o}}catch(e){console.log("ERROR",e)}}))}function vt(){var e,t=p("style");t.innerHTML="\n        .wallkit-modal-wrapper {\n            z-index: 100;\n            position: fixed;\n            top: 0;\n            left: 0;\n            right: 0;\n            bottom: 0;\n            background: rgba(18, 18, 20, 0.9);\n            display: flex;\n            align-items: center;\n            justify-content: flex-start;\n            flex-direction: column;\n            overflow-y: auto;\n            padding: 70px 15px 20px;\n        }\n\n        .wallkit-modal-wrapper__content {\n            background-color: #fff;\n            flex-shrink: 0;\n            position: relative;\n            box-sizing: border-box;\n        }\n\n        .wallkit-modal-wrapper__close-btn {\n            position: absolute;\n            right: 10px;\n            top: 10px;\n            cursor: pointer;\n            color: #000;\n            font-size: 37px;\n            width: 37px;\n            height: 37px;\n            text-align: center;\n            line-height: 34px;\n        }\n\n        .wallkit-modal-wrapper .wk-frame {\n            transition: all 0.3s linear 0s;\n            max-width: 100%;\n            border: none;\n        }\n\n        .wallkit-auth-modal {\n            z-index: 999;\n        }\n\n        .wallkit-auth-modal .wallkit-modal-wrapper__content {\n            padding: 20px;\n        }\n\n        .wallkit-auth-modal .wallkit-auth-modal__title {\n            font-family: Roboto, sans-serif;\n            text-align: center;\n        }\n\n        button:focus {\n            background-color: #000;\n        }\n",e=t,f()?e?document.head.appendChild(e):h.checkRequiredArgument(e,"element"):h.handleError("Document is not available",u.DOM_ERROR)}window.WallkitIntegration=(it=new WeakSet,ot=new WeakSet,function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),ot.add(this),it.add(this),this.config=t,this.events=new E,this.frame=new Re(ct(ct({},t),{},{onReady:function(){return n.popup.toggleLoader(!1)}})),this.popup=new ne({resourceFrame:this.frame,initialLoader:!0,onReady:function(e){e.openByHash()},onClose:function(){n.events.notify(S,{name:n.frame.currentFrameName})}}),this.sdk=new De(ct(ct({},t),{},{onLoaded:function(){var e,i,o,r,a;n.authentication=new Ze({firebase:null==t||null===(e=t.auth)||void 0===e?void 0:e.firebase,modalTitle:null===(i=t.auth)||void 0===i||null===(o=i.modal)||void 0===o?void 0:o.title,content:null===(r=t.auth)||void 0===r||null===(a=r.modal)||void 0===a?void 0:a.content}),n.analytics=new lt(null==t?void 0:t.analytics),n.init()}}))}var t,n;return t=e,(n=[{key:"modal",value:function(e,t){this.popup.open(e,t)}},{key:"init",value:function(){dt(this,ot,vt).call(this),this.popup.init(),this.authentication.init(),this.analytics.init(),dt(this,it,pt).call(this)}}])&&ft(t.prototype,n),e}()),WallkitIntegration})();