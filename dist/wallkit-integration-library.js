(()=>{"use strict";var e="https://cdn.wallkit.net",t=e+"/assets",n=[document.location.origin,"http://127.0.0.1:8000","https://wallkit.net","https://dev.wallkit.net","https://demo.wallkit.net"],i="500",a="250",o="firebase-ui-placeholder",r="wk-frame",s={apiKey:"AIzaSyAoRdxZIlUE0HInqtzDid6rNxluhs5nCqg",authDomain:"wallkit-production.firebaseapp.com",databaseURL:"https://wallkit-production.firebaseio.com",projectId:"wallkit-production",storageBucket:"wallkit-production.appspot.com",messagingSenderId:"779443518820",appId:"1:779443518820:web:ffc6660647590674e20e71",measurementId:"G-GWJ1GC5B30"};function l(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var u={DOM_ERROR:"DOM_ERROR",ARGUMENT_ERROR:"ARGUMENT_ERROR"},c={DOM_ERROR:"DOM Manipulation gone wrong",ARGUMENT_ERROR:"One of the argument were not provided"},h=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,n=[{key:"isErrorRecognisable",value:function(e){return!!u[e]}},{key:"getErrorTypeMessage",value:function(e){var t;return null!==(t=c[e])&&void 0!==t?t:"Unrecognised Error"}},{key:"handleError",value:function(t,n){if(n&&this.isErrorRecognisable(n)){var i=null!=t?t:e.getErrorTypeMessage(n),a="ERROR::".concat(n,"; ").concat(i,";");throw console.log(a),new e(a)}var o="ERROR::".concat(n,";");throw console.log(o),new e(o)}},{key:"checkRequiredArgument",value:function(e,t){void 0===e&&this.handleError("Argument ".concat(t," is not provided"),u.ARGUMENT_ERROR)}}],null&&l(t.prototype,null),n&&l(t,n),e}(),f=function(){return!!document},d=function(e){return f()?!!document.querySelector(e):h.handleError("Document is not available",u.DOM_ERROR)},v=function(e,t){if(!f())return h.handleError("Document is not available",u.DOM_ERROR);if(!e)return h.checkRequiredArgument(e);var n=document.createElement(e),i=null!=t?t:{},a=i.id,o=i.className,r=i.styles,s=i.attributes;if(a&&(n.id=a),o&&n.setAttribute("class",o),r&&Object.keys(r)&&Object.keys(r).length)for(var l in r)r.hasOwnProperty(l)&&(n.style[l]=r[l]);if(s&&Object.keys(s)&&Object.keys(s).length)for(var c in s)s.hasOwnProperty(c)&&(n[c]=s[c]);return n},p=function(e){return f()?e?document.body.appendChild(e):h.checkRequiredArgument(e,"element"):h.handleError("Document is not available",u.DOM_ERROR)},m=function(e,t){if(!f())return h.handleError("Document is not available",u.DOM_ERROR);if(!d("#"+t)){var n=document.querySelector("head"),i=document.createElement("link");return t&&(i.id=t),i.rel="stylesheet",i.type="text/css",i.href=e,i.media="all",n.appendChild(i)}},b=function(e,t,n){if(!f())return h.handleError("Document is not available",u.DOM_ERROR);if(!d("#"+t)){var i=v("script",{id:t,attributes:{src:e}});return n&&i.addEventListener("load",n,{once:!0}),p(i)}};const w=v,y=p,k=d;function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function R(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function T(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}var j=new WeakSet,S=new WeakSet,P=new WeakSet,A=new WeakSet,C=new WeakSet,W=new WeakSet,I=new WeakSet,L=new WeakSet,M=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),L.add(this),I.add(this),W.add(this),C.add(this),A.add(this),P.add(this),S.add(this),j.add(this),this.options=t,this.modalFrame=t?t.resourceFrame:null,this.content=t?t.content:null,this.modalWrapper=null,this.modalContent=null,this.loaderElement=null,this.isLoading=!1,this.closeOutside=!0}var t,n;return t=e,(n=[{key:"bindCloseEvent",value:function(e){return e.addEventListener("click",this.hide.bind(this))}},{key:"insertContent",value:function(e){this.modalContent&&e&&("string"==typeof e?this.modalContent.insertAdjacentHTML("beforeend",e):e instanceof HTMLElement&&this.modalContent.appendChild(e))}},{key:"toggleLoader",value:function(e){this.isLoading=e,this.loaderElement.style.display=e?"flex":"none"}},{key:"open",value:function(e,t){this.modalFrame&&(this.modalFrame.openFrame(e,t),this.show())}},{key:"destroy",value:function(){}},{key:"show",value:function(){this.modalWrapper.style.display="flex"}},{key:"hide",value:function(){this.modalWrapper.style.display="none"}},{key:"resize",value:function(e,t){this.modalFrame&&this.modalFrame.resize(e,t)}},{key:"sendEvent",value:function(e,t,n){this.modalFrame&&this.modalFrame.sendEvent(e,t,n)}},{key:"openByHash",value:function(){var e=function(){var e=/#WkModal\((.*)\)$/.exec(decodeURIComponent(window.location.hash));if(e&&e[1]){var t=e[1].split(/,(.+)/);if(void 0!==t[1])try{t[1]=JSON.parse(t[1])}catch(e){t[1]={value:t[1].trim()}}return window.location.hash="",{name:t[0],params:"object"===g(t[1])?t[1]:null}}}();e&&this.open(e.name,e.params)}},{key:"onReady",value:function(){var e;null!==(e=this.options)&&void 0!==e&&e.onReady&&this.options.onReady(this)}},{key:"init",value:function(){T(this,A,F).call(this),T(this,C,U).call(this),T(this,W,N).call(this),T(this,I,z).call(this),this.onReady()}}])&&R(t.prototype,n),e}();function _(){var e,t;return null!==(e=null===(t=this.options)||void 0===t?void 0:t.modalName)&&void 0!==e?e:"wk-modal"}function x(e,t,n){for(var i=T(this,j,_).call(this)+"-"+t,a=0,o=i;k("#"+o);)o=i+"-"+ ++a;return w(e,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){E(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({id:o},n))}function D(){var e=T(this,S,x).call(this,"div","close-btn",{className:"wallkit-modal-wrapper__close-btn"});return e.innerHTML="&#xd7;",this.bindCloseEvent(e),e}function F(){var e,t,n=this,i="wallkit-modal-wrapper";return null!==(e=this.options)&&void 0!==e&&e.className&&(i+=" "+(null===(t=this.options)||void 0===t?void 0:t.className)),this.modalWrapper=T(this,S,x).call(this,"div","wrapper",{styles:{display:"none"},className:i}),this.modalWrapper.addEventListener("click",(function(e){e.target.id===n.modalWrapper.id&&n.closeOutside&&n.hide()})),this.modalWrapper}function U(){return this.modalContent=T(this,S,x).call(this,"div","content",{className:"wallkit-modal-wrapper__content"}),this.modalContent.style.minWidth="500px",this.modalContent.style.minHeight="250px",this.modalContent}function N(){var e;this.loaderElement=T(this,S,x).call(this,"div","wallkit-modal-spinner",{className:"wallkit-spinner",styles:{display:null!==(e=this.options)&&void 0!==e&&e.initialLoader?"flex":"none"}}),this.loaderElement.insertAdjacentHTML("beforeend",'<div class="wallkit-spinner__container"><div class="cube1"></div><div class="cube2"></div></div>')}function z(){return T(this,L,G).call(this),this.modalWrapper.appendChild(T(this,P,D).call(this)),this.modalWrapper.appendChild(this.modalContent),this.modalContent.appendChild(this.loaderElement),this.modalFrame?this.insertContent(this.modalFrame.init()):this.modalContent&&this.insertContent(this.content),y(this.modalWrapper)}function G(){!function(e,n,i){var a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];switch(e){case"css":var o=i;return o+=a?".min.css":".css",void m("".concat(t,"/css/").concat(n,"/").concat(o),"wk-css-".concat(i));default:;}}("css","1.0","spinner")}function H(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function q(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}var B=new WeakSet,V=new WeakSet,J=function(){function e(t){var n,i,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),V.add(this),B.add(this),this.config=null==t?void 0:t.config,this.providers=null==t?void 0:t.providers,this.tosURL=null==t?void 0:t.tosURL,this.privacyPolicyURL=null==t?void 0:t.privacyPolicyURL,this.firebase=null,this.firebaseui=null,this.elementPlaceholder=null!==(n=null==t?void 0:t.elementPlaceholder)&&void 0!==n?n:"#".concat(o),this.onSuccessAuth=null!==(i=null==t?void 0:t.onSuccessAuth)&&void 0!==i?i:null,this.onAuthStateChanged=null!==(a=null==t?void 0:t.onAuthStateChanged)&&void 0!==a?a:null,this.uiShown=null!==(r=null==t?void 0:t.uiShown)&&void 0!==r?r:null}var t,n;return t=e,(n=[{key:"allowedProviders",get:function(){return{google:this.firebase.auth.GoogleAuthProvider.PROVIDER_ID,email:this.firebase.auth.EmailAuthProvider.PROVIDER_ID,facebook:this.firebase.auth.FacebookAuthProvider.PROVIDER_ID,microsoft:"microsoft.com"}}},{key:"formatSelectedProviders",value:function(e){var t=this,n=[];return Array.isArray(e)&&(n=e.map((function(e){if(t.allowedProviders[e])return t.allowedProviders[e]})).filter((function(e){return!!e}))),n}},{key:"initFirebase",value:function(e){var t=this,n=e.config,i=e.providers,a=void 0===i?["email","google"]:i,o=e.tosUrl,r=void 0===o?"https://wallkit.net":o,l=e.privacyPolicyUrl,u=void 0===l?"https://wallkit.net":l;this.firebase.initializeApp(null!=n?n:s);var c=new this.firebaseui.auth.AuthUI(this.firebase.auth());c.disableAutoSignIn();var h={callbacks:{signInSuccessWithAuthResult:function(e){e.user.getIdToken().then((function(n){var i={user:e.user,userId:e.user.uid,token:n};t.onSuccessAuth&&t.onSuccessAuth(i,e)}))},uiShown:function(){t.uiShown&&t.uiShown()}},signInFlow:"popup",signInOptions:this.formatSelectedProviders(a),credentialHelper:this.firebaseui.auth.CredentialHelper.GOOGLE_YOLO,tosUrl:r,privacyPolicyUrl:u};c.start(this.elementPlaceholder,h),this.firebaseui=c,this.firebase.auth().onAuthStateChanged(q(this,V,Y).bind(this))}},{key:"reset",value:function(){this.firebaseui&&(this.firebaseui.reset(),this.firebaseui.start(this.elementPlaceholder))}},{key:"logout",value:function(){var e=this;return new Promise((function(t){e.firebase&&e.firebase.auth?e.firebase.auth().signOut().then((function(){return t(!0)})):t(!1)}))}},{key:"init",value:function(){var e=this;q(this,B,K).call(this).then((function(){e.initFirebase({config:e.config,providers:e.providers,tosUrl:e.tosURL,privacyPolicyUrl:e.privacyPolicyURL})}))}}])&&H(t.prototype,n),e}();function K(){var e=this;return new Promise((function(t,n){b("https://www.gstatic.com/firebasejs/8.7.0/firebase-app.js","firebase-app",(function(){var n=[{url:"https://www.gstatic.com/firebasejs/8.7.0/firebase-analytics.js",id:"firebase-analytics",defer:!0,onload:function(){return a()}},{url:"https://www.gstatic.com/firebasejs/8.7.0/firebase-auth.js",id:"firebase-auth",defer:!0,onload:function(){return a()}},{url:"https://www.gstatic.com/firebasejs/8.7.0/firebase-firestore.js",id:"firebase-firestore",defer:!0,onload:function(){return a()}},{url:"https://www.gstatic.com/firebasejs/ui/4.8.0/firebase-ui-auth.js",id:"firebase-ui",defer:!0,onload:function(){return a()}}],i=0,a=function(){++i===n.length&&(e.firebase=window.firebase,e.firebaseui=window.firebaseui,t({firebase:window.firebase,firebaseui:window.firebaseui}))};(function(e){Array.isArray(e)&&e.forEach((function(e){b(e.url,e.id,e.onload)}))})(n),m("https://www.gstatic.com/firebasejs/ui/4.8.0/firebase-ui-auth.css","firebase-ui-styles")}))}))}function Y(e){var t=this;e&&e.getIdToken().then((function(e){t.onAuthStateChanged&&t.onAuthStateChanged(e)}))}var Z="frame-created",$="success-auth",Q="wallkit-js-sdk-loaded",X="frame-message",ee="wk-event-modal",te="wk-event-modals-ready";const ne=$,ie="success-firebase-auth",ae=X,oe="wk-event-logout",re="wk-firebase-token",se="wk-event-firebase-token",le="wk-event-token",ue="wk-event-get-token",ce="wk-event-auth",he="wk-event-registration",fe="wk-event-one-tap-sign-in";function de(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ve=function(){function e(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),e.instance?e.instance:(e.instance=this,this.listeners=[],this)}var t,n;return t=e,(n=[{key:"subscribe",value:function(e,t,n){this.listeners.push({name:e,callback:t,options:n})}},{key:"unsubscribe",value:function(e,t){this.listeners=this.listeners.filter((function(n){return n.name!==e&&n.callback!==t}))}},{key:"notify",value:function(e,t){var n=this;this.listeners.forEach((function(i,a){var o;e===i.name&&(i.callback(t),null!=i&&null!==(o=i.options)&&void 0!==o&&o.once&&n.listeners.splice(a,1))}))}}])&&de(t.prototype,n),e}();function pe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var me=new WeakSet,be=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),me.add(this),e.instance)return e.instance;e.instance=this,this.options=t,this.frameElement=null,this.ready=!1,this.events=new ve}var t,n;return t=e,(n=[{key:"element",get:function(){return this.frameElement}},{key:"getFrameURL",get:function(){return"".concat("https://wallkit.net/popups","?PUBLIC_KEY=").concat(this.options.public_key,"&version=").concat(this.options.version)}},{key:"createFrame",value:function(){return this.frameElement=v("iframe",{id:r,className:r,attributes:{scrolling:"no",allowtransparency:"true",frameborder:"0",width:i,height:a}}),this.frameElement.setAttribute("src",this.getFrameURL),this.events.notify(Z,!0),this.frameElement}},{key:"resize",value:function(e,t){e=e>=i?e:i,t=t>=a?t:a,this.frameElement&&(this.frameElement.width=e,this.frameElement.height=t)}},{key:"sendEvent",value:function(e,t,n){if(this.frameElement&&this.frameElement.contentWindow){var i=this.frameElement.contentWindow;this.events.notify(e,t),i.postMessage({name:e,value:t,params:n},"*")}}},{key:"openFrame",value:function(e,t){var n=this;this.ready?this.sendEvent(ee,e,t):this.events.subscribe(te,(function(){n.sendEvent(ee,e,t)}),{once:!0})}},{key:"onFrameReady",value:function(){var e,t;this.ready=!0,null!==(e=this.options)&&void 0!==e&&e.onReady&&(null===(t=this.options)||void 0===t||t.onReady())}},{key:"init",value:function(){return function(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}(this,me,we).call(this),this.createFrame()}}])&&pe(t.prototype,n),e}();function we(){var e=this;this.events.subscribe(te,(function(t){!0===t&&e.onFrameReady()}))}function ye(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ke(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,Oe(e,t,"get"))}function ge(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,Oe(e,t,"set"),n),n}function Oe(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var Ee=new WeakMap,Re=new WeakMap,Te=function(){function t(e){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ee.set(this,{writable:!0,value:void 0}),Re.set(this,{writable:!0,value:void 0}),t.instance)return t.instance;t.instance=this,this.methods=null,ge(this,Ee,e),ge(this,Re,new ve),this.load()}var n,i;return n=t,(i=[{key:"onLoad",value:function(){var e,t;window.Wallkit&&(window.Wallkit.init({resource:ke(this,Ee).public_key}),this.methods=window.Wallkit,ke(this,Re).notify(Q,window.Wallkit),null!==(e=ke(this,Ee))&&void 0!==e&&e.onLoaded&&(null===(t=ke(this,Ee))||void 0===t||t.onLoaded()))}},{key:"awaitLoad",value:function(){var e=this;return new Promise((function(t){e.methods?t(e):ke(e,Re).subscribe(Q,(function(){return t(e)}))}))}},{key:"load",value:function(){b("".concat(e,"/js/sdk/0.0.41/wallkit.umd.min.js"),"wallkit-js-sdk",this.onLoad.bind(this))}}])&&ye(n.prototype,i),t}();const je={setItem:function(e,t){return this.isAvailable()?window.localStorage.setItem(e,t):null},getItem:function(e){return this.isAvailable()?window.localStorage.getItem(e):null},removeItem:function(e){if(this.isAvailable())return window.localStorage.removeItem(e)},isAvailable:function(){try{return window.localStorage.setItem("",""),window.localStorage.removeItem(""),!0}catch(e){return!1}}};function Se(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Pe(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,Ae(e,t,"get"))}function Ae(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var Ce=new WeakMap,We=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Ce.set(this,{writable:!0,value:void 0}),t&&(function(e,t,n){(function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}})(e,Ae(e,t,"set"),n)}(this,Ce,t),n?this.set(n):this.token=this.getStoredTokenValue()||null)}var t,n;return t=e,(n=[{key:"get",value:function(){return this.token}},{key:"getStoredTokenValue",value:function(){return je.getItem(Pe(this,Ce))||null}},{key:"remove",value:function(){var e;this.token=null,e=Pe(this,Ce),document.cookie="".concat(e,"=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;"),je.removeItem(Pe(this,Ce))}},{key:"set",value:function(e){this.token=e,function(e,t,n){var i=(n=n||{}).expires;if("number"==typeof i&&i){var a=new Date;a.setTime(a.getTime()+1e3*i),i=n.expires=a}i&&i.toUTCString&&(n.expires=i.toUTCString()),t=encodeURIComponent(t);var o="".concat(e,"=").concat(t);for(var r in n){o+="; "+r;var s=n[r];s&&(o+="="+s)}document.cookie=o}(Pe(this,Ce),e,{expires:"Fri, 31 Dec 9999 23:59:59 GMT",path:"/"}),je.setItem(Pe(this,Ce),e)}}])&&Se(t.prototype,n),e}();function Ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Le(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ie(Object(n),!0).forEach((function(t){Me(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ie(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Me(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _e(e){return(_e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function De(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var Fe=new WeakMap,Ue=new WeakSet,Ne=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Ue.add(this),Fe.set(this,{writable:!0,value:void 0}),e.instance)return e.instance;if(e.instance=this,a=t,function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(i=this,De(i,Fe,"set"),a),this.token=new We("wk-token"),this.firebaseToken=new We("firebase-token"),this.frame=new be,this.sdk=new Te,null!=t&&t.firebase){this.modal=function(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}(this,Ue,ze).call(this),this.modal.init();var n={onAuthStateChanged:this.updateFirebaseToken.bind(this),onSuccessAuth:this.onSuccessAuth.bind(this),uiShown:this.onFirebaseInit.bind(this),onAuthFail:this.onFirebaseAuthFail.bind(this)};console.log("options.firebase",t.firebase),"object"===_e(t.firebase)&&(n=Le(Le({},n),t.firebase)),this.firebase=new J(n),this.firebase.init()}var i,a;this.events=new ve}var t,n;return t=e,(n=[{key:"isAuthenticated",value:function(){return this.sdk?this.sdk.methods.isAuthenticated():!!this.token.get()}},{key:"onSuccessAuth",value:function(e){var t=this;this.modal.toggleLoader(!0),this.updateFirebaseToken(e.token),this.events.notify(ie,e),this.authInWallkit(e.token).then((function(e){e&&(t.modal.hide(),t.modal.toggleLoader(!1))}))}},{key:"authInWallkit",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return new Promise((function(n){t?e.sdk.methods.authenticateWithFirebase(t).then((function(t){var i=t.token;e.setToken(i),e.events.notify(ne,!0),n(!0)})):n(!1)}))}},{key:"show",value:function(){this.modal.show()}},{key:"updateFirebaseToken",value:function(e){this.firebaseToken.set(e),this.frame.sendEvent(se,e)}},{key:"onFirebaseInit",value:function(){this.modal.toggleLoader(!1)}},{key:"removeToken",value:function(){this.token.remove()}},{key:"removeFirebaseToken",value:function(){this.firebaseToken.remove()}},{key:"setToken",value:function(e){this.token.set(e)}},{key:"initListeners",value:function(){var e=this;this.events.subscribe(oe,(function(){return e.logout()})),this.events.subscribe(re,(function(t){e.firebaseToken.set(t),e.sdk.methods.setFirebaseToken(t)})),this.events.subscribe(ae,(function(t){var n=t.name,i=t.value;switch(n){case ce:case he:case ue:case le:if(i){var a=i.token;e.setToken(a)}}}))}},{key:"logout",value:function(){var e=this;this.removeToken(),this.firebase.logout().then((function(t){t&&e.removeFirebaseToken()}))}},{key:"dispatchTokens",value:function(){this.isAuthenticated()&&(this.token.get()&&this.frame.sendEvent(le,this.token.get()),this.firebaseToken.get()&&this.frame.sendEvent(se,this.firebaseToken.get()))}},{key:"onFirebaseAuthFail",value:function(e){this.modal.toggleLoader(!1),console.log("error",e)}},{key:"handleOneTapResponse",value:function(e){var t=e.credential;this.frame.sendEvent(fe,t)}},{key:"init",value:function(){this.initListeners()}}])&&xe(t.prototype,n),e}();function ze(){var e,t,n;return new M({modalName:"auth-modal",content:'<div>\n                        <h2 class="wallkit-auth-modal__title">'.concat(null!==(e=null===(this,n=Fe,t=function(e,t){return t.get?t.get.call(e):t.value}(this,De(this,n,"get")))||void 0===t?void 0:t.modalTitle)&&void 0!==e?e:"Sign In",'</h2>\n                        <div id="').concat(o,'"></div>\n                      </div>'),className:"wallkit-auth-modal",initialLoader:!0})}function Ge(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function He(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,Be(e,t,"get"))}function qe(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,Be(e,t,"set"),n),n}function Be(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var Ve,Je,Ke=new WeakMap,Ye=new WeakMap,Ze=new WeakMap,$e=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Ke.set(this,{writable:!0,value:void 0}),Ye.set(this,{writable:!0,value:void 0}),Ze.set(this,{writable:!0,value:void 0}),qe(this,Ke,{parseUTM:void 0===(null==t?void 0:t.parseUTM)||t.parseUTM}),qe(this,Ze,new Ne),qe(this,Ye,new Te),this.utmTags={}}var t,n;return t=e,(n=[{key:"parseUTMTags",value:function(){if(!window.location.search.includes("utm"))return{};var e=new URLSearchParams(window.location.search),t={};return["utm_source","utm_medium","utm_campaign"].forEach((function(n){e.get(n)&&(t[n]=e.get(n))})),this.utmTags=t,He(this,Ze).isAuthenticated()&&He(this,Ye).methods.updateUser({extra:this.utmTags}),t}},{key:"hasUTMTags",get:function(){return!!Object.keys(this.utmTags).length}},{key:"init",value:function(){!1!==He(this,Ke).parseUTM&&this.parseUTMTags()}}])&&Ge(t.prototype,n),e}();function Qe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Xe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qe(Object(n),!0).forEach((function(t){et(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function et(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function tt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function nt(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}function it(){var e=this;window.addEventListener("message",(function(t){var i=t.data,a=i.value,o=i.name,r=t.origin;e.events.notify(o,a),e.events.notify(X,{name:o,value:a});try{if(n.includes(r)&&void 0!==a&&o)switch(o){case"wk-event-modals-ready":e.authentication.isAuthenticated()?e.frame.sendEvent("wk-event-applepay-ready",function(){try{return!!window.ApplePaySession&&window.ApplePaySession.canMakePayments()}catch(e){return console.error("ApplePay Error",e),!1}}()):e.frame.sendEvent("wk-event-get-token",e.config.public_key);break;case"wk-event-resize":0!==a.width&&0!==a.height&&e.modal.resize(a.width,a.height);break;case"show-firebase-auth":var s=a;e.authentication.show(),e.events.subscribe($,(function(){e.modal.open(s)}),{once:!0});break;case"wk-event-close-modal":e.modal.hide();break;case"wk-event-reload-page":e.modal.hide(),location.reload();break;case"wk-event-storage-available":a||e.authentication.dispatchTokens();break;case"wk-event-close-on-wrapper":e.modal.closeOutside=a}}catch(e){console.log("ERROR",e)}}))}function at(){var e,t=v("style");t.innerHTML="\n        .wallkit-modal-wrapper {\n            z-index: 100;\n            position: fixed;\n            top: 0;\n            left: 0;\n            right: 0;\n            bottom: 0;\n            background: rgba(18, 18, 20, 0.9);\n            display: flex;\n            align-items: center;\n            justify-content: flex-start;\n            flex-direction: column;\n            overflow-y: auto;\n            padding: 70px 15px 20px;\n        }\n\n        .wallkit-modal-wrapper__content {\n            background-color: #fff;\n            flex-shrink: 0;\n            position: relative;\n            box-sizing: border-box;\n        }\n\n        .wallkit-modal-wrapper__close-btn {\n            position: absolute;\n            right: 10px;\n            top: 10px;\n            cursor: pointer;\n            color: #fff;\n            font-size: 37px;\n            width: 37px;\n            height: 37px;\n            text-align: center;\n            line-height: 34px;\n        }\n\n        .wallkit-modal-wrapper .wk-frame {\n            transition: all 0.3s linear 0s;\n            max-width: 100%;\n            border: none;\n        }\n\n        .wallkit-auth-modal {\n            z-index: 999;\n        }\n\n        .wallkit-auth-modal .wallkit-modal-wrapper__content {\n            padding: 20px;\n        }\n\n        .wallkit-auth-modal .wallkit-auth-modal__title {\n            font-family: Roboto, sans-serif;\n            text-align: center;\n        }\n\n        button:focus {\n            background-color: #000;\n        }\n",e=t,f()?e?document.head.appendChild(e):h.checkRequiredArgument(e,"element"):h.handleError("Document is not available",u.DOM_ERROR)}window.WallkitIntegration=(Ve=new WeakSet,Je=new WeakSet,function(){function e(t){var n,i,a,o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Je.add(this),Ve.add(this),this.config=t,this.sdk=new Te(Xe(Xe({},t),{},{onLoaded:function(){return o.init()}})),this.frame=new be(Xe(Xe({},t),{},{onReady:function(){return o.modal.toggleLoader(!1)}})),this.modal=new M({resourceFrame:this.frame,initialLoader:!0,onReady:function(e){e.openByHash()}}),this.authentication=new Ne({firebase:null==t||null===(n=t.auth)||void 0===n?void 0:n.firebase,modalTitle:null===(i=t.auth)||void 0===i||null===(a=i.modal)||void 0===a?void 0:a.title}),this.analytics=new $e(null==t?void 0:t.analytics),this.events=new ve}var t,n;return t=e,(n=[{key:"init",value:function(){nt(this,Je,at).call(this),this.modal.init(),this.authentication.init(),this.analytics.init(),nt(this,Ve,it).call(this)}}])&&tt(t.prototype,n),e}()),WallkitIntegration})();